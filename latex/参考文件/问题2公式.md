问题2公式

好的，这是轮廓系数（Silhouette Coefficient）、DBI（Davies-Bouldin Index）和CH指数（Calinski-Harabasz Index）的详细计算公式。

---

### 1. 轮廓系数 (Silhouette Coefficient)

轮廓系数的计算分为两个层次：先计算每个样本的轮廓系数，再对所有样本取平均值。

#### a) 对于单个样本 \( i \) 的轮廓系数 \( s(i) \)：

\[
s(i) = \frac{b(i) - a(i)}{\max\{a(i), b(i)\}}
\]

*   **\( a(i) \)**: 样本 \( i \) 到**同一簇内**所有其他样本的平均距离。**（凝聚度）**
    *   这个值越小，说明样本 \( i \) 越应该被分到这个簇，簇内越紧凑。
*   **\( b(i) \)**: 样本 \( i \) 到**其他某个簇**的所有样本的平均距离。计算样本 \( i \) 与所有**非本身所在簇**的的平均距离，然后取其中的**最小值**。**（分离度）**
    *   \( b(i) = \min\{d(i, C_k)\} \) 对于所有 \( k \)，其中 \( C_k \) 不是样本 \( i \) 所属的簇。
    *   \( d(i, C_k) \) 是样本 \( i \) 到簇 \( C_k \) 中所有样本的平均距离。
    *   这个值越大，说明样本 \( i \) 离其他簇越远，簇间分离得越好。

**因此：**
*   \( s(i) \) 接近 1：表示 \( b(i) \gg a(i) \)，样本聚类合理，远离其他簇。
*   \( s(i) \) 接近 0：表示 \( b(i) \approx a(i) \)，样本处于两个簇的边界上。
*   \( s(i) \) 接近 -1：表示 \( b(i) \ll a(i) \)，样本可能被分配到了错误的簇。

#### b) 整个数据集的轮廓系数 \( SC \)：

\[
SC = \frac{1}{N} \sum_{i=1}^{N} s(i)
\]
其中 \( N \) 是数据集中所有样本的总数。整个数据集的轮廓系数就是所有样本个体轮廓系数的平均值。

---

### 2. DBI (Davies-Bouldin Index)

DBI 的计算着眼于簇与簇之间的“相似性”，并取平均值。

\[
DBI = \frac{1}{K} \sum_{i=1}^{K} \max_{j \neq i} R_{ij}
\]

*   **\( K \)**: 簇的个数。
*   **\( R_{ij} \)**: 簇 \( i \) 和簇 \( j \) 之间的**相似度**，计算公式为：
    \[
    R_{ij} = \frac{s_i + s_j}{d_{ij}}
    \]
*   **\( s_i \)**: 簇 \( i \) 的**簇内散度**，即簇内所有样本到其质心 \( c_i \) 的平均距离。
    \[
    s_i = \frac{1}{|C_i|} \sum_{x \in C_i} \|x - c_i\|
    \] （\( |C_i| \) 是簇 \( i \) 中的样本数）
*   **\( d_{ij} \)**: 簇 \( i \) 的质心 \( c_i \) 与簇 \( j \) 的质心 \( c_j \) 之间的距离（通常使用欧氏距离）。

**计算过程：**
1.  对于每一个簇 \( i \)，找到那个能使其相似度 \( R_{ij} \) **最大**的簇 \( j \)（即最“坏”的、最相似的对手簇）。
2.  将这个最坏的 \( R_{ij} \) 值作为簇 \( i \) 的得分。
3.  将所有簇的得分求平均，得到最终的 DBI。

**DBI 越小越好**，因为 \( R_{ij} \) 小意味着簇内散度 \( s \) 小 和/或 簇间距离 \( d \) 大。

---

### 3. CH 指数 (Calinski-Harabasz Index)

CH 指数基于方差分析（ANOVA）的思想，计算簇间离散度与簇内离散度的比值。

\[
CH = \frac{\text{SS}_B / (K - 1)}{\text{SS}_W / (N - K)}
\]

*   **\( N \)**: 数据集中的总样本数。
*   **\( K \)**: 簇的个数。
*   **\( \text{SS}_B \)**: **簇间离散度**（Between-Cluster Sum of Squares）。所有簇的质心 \( c_k \) 与全局质心 \( c \) 的距离平方和，并按簇大小加权。
    \[
    \text{SS}_B = \sum_{k=1}^{K} n_k \|c_k - c\|^2
    \]
    *   \( n_k \): 簇 \( k \) 中的样本数。
    *   \( c_k \): 簇 \( k \) 的质心。
    *   \( c \): 整个数据集的全局质心。
*   **\( \text{SS}_W \)**: **簇内离散度**（Within-Cluster Sum of Squares）。所有样本点到其所属簇的质心的距离平方和。
    \[
    \text{SS}_W = \sum_{k=1}^{K} \sum_{x \in C_k} \|x - c_k\|^2
    \]

**解释：**
*   **分子 \( \text{SS}_B \)**: 衡量不同簇之间的分离程度。值越大，说明簇间差异越大。
*   **分母 \( \text{SS}_W \)**: 衡量簇内的紧密程度。值越小，说明簇内样本越相似。
*   **比值**: 因此，**CH 指数越大**，意味着簇间离散度大而簇内离散度小，即**聚类效果越好**。

公式中的 \( (K-1) \) 和 \( (N-K) \) 是自由度，用于对分子和分母进行标准化，使得指标可以用于比较不同 \( K \) 值下的聚类结果。

### 总结

| 指标    | 核心思想                                  | 公式                                                         | 方向     |
| :------ | :---------------------------------------- | :----------------------------------------------------------- | :------- |
| **SC**  | 衡量单个样本的聚类合理性后平均            | \( SC = \frac{1}{N} \sum_{i=1}^{N} \frac{b(i) - a(i)}{\max\{a(i), b(i)\}} \) | 越大越好 |
| **DBI** | 衡量最相似簇对的平均“不相似”程度          | \( DBI = \frac{1}{K} \sum_{i=1}^{K} \max_{j \neq i} \left( \frac{s_i + s_j}{d_{ij}} \right) \) | 越小越好 |
| **CH**  | 簇间方差与簇内方差的比值（类似 F 统计量） | \( CH = \frac{\text{SS}_B / (K - 1)}{\text{SS}_W / (N - K)} \) | 越大越好 |